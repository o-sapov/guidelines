<p xmlns="http://www.tei-c.org/ns/1.0">When encoding a score in CMN, MEI relies on the following elements from the <ptr target="shared"/> module: <specList>
      <specDesc key="scoreDef"/>
   </specList>
   <specList>
      <specDesc key="staffGrp"/>
   </specList>
   <specList>
      <specDesc key="staffDef"/>
   </specList>
   <specList>
      <specDesc key="layerDef"/>
   </specList> A <gi scheme="MEI">scoreDef</gi> element is used to specify the common parameters of a score, e.g., key and meter. The most important attributes for this purpose are: <specList>
      <specDesc key="att.meterSigDefault.log" atts="meter.count meter.unit"/>
   </specList>
   <specList>
      <specDesc key="att.meterSigDefault.log" atts="meter.sym"/>
   </specList>
   <specList>
      <specDesc key="att.keySigDefault.log" atts="key.sig"/>
   </specList> The following example describes a score in common time with 3 flats:  Other attributes allow the description of default page and system margins and fonts for text and music: <specList>
      <specDesc key="att.pages"
                atts="page.width page.height page.leftmar page.topmar page.rightmar page.botmar"/>
      <specDesc key="att.systems" atts="system.leftmar system.topmar system.rightmar"/>
      <specDesc key="att.textStyle" atts="text.name text.fam text.size"/>
      <specDesc key="att.notationStyle" atts="music.name music.size"/>
      <specDesc key="att.lyricStyle" atts="lyric.name lyric.fam lyric.size"/>
   </specList> There are other attributes that allow the specification of many further details of a score. These are available from the element definitions accessible at <gi scheme="MEI">scoreDef</gi>, <gi scheme="MEI">staffDef</gi>, <gi scheme="MEI">staffGrp</gi> and <gi scheme="MEI">layerDef</gi>. When content is provided for <gi scheme="MEI">scoreDef</gi>, it must contain a <gi scheme="MEI">staffGrp</gi> element. This element is used to gather individual staves and other staff groups. This is useful for collecting instrumental or vocal groups in a large score, such as woodwinds, brasses, etc., and for assigning a shared label to the group, using the <gi scheme="MEI">label</gi> and <gi scheme="MEI">labelAbbr</gi> subelements. The <gi scheme="MEI">staffGrp</gi> element is also used for the two staves of a grand staff. The<hi rend="bold">@bar.thru</hi>attribute on <gi scheme="MEI">staffGrp</gi> allows one to specify whether barlines are drawn across the space between staves of that group or only on the staves themselves. A <gi scheme="MEI">staffDef</gi> element is used to describe an individual staff of a <gi scheme="MEI">score</gi> or performer <gi scheme="MEI">part</gi>. It bears most of the attributes described above. The <gi scheme="MEI">label</gi> and <gi scheme="MEI">labelAbbr</gi> subelements may be used for providing staff labels for the first and subsequent systems. Every <gi scheme="MEI">staffDef</gi> must have an<hi rend="bold">@n</hi>attribute with an integer as its value. The first occurence of a <gi scheme="MEI">staffDef</gi> with a given number must also indicate the number of staff lines via the<hi rend="bold">@lines</hi>attribute. The order of <gi scheme="MEI">staffDef</gi> elements within <gi scheme="MEI">scoreDef</gi> follows the order of staves in the source document or planned rendering. The individual <gi scheme="MEI">staff</gi> elements within a <gi scheme="MEI">measure</gi> refer to these <gi scheme="MEI">staffDef</gi> declarations using their own<hi rend="bold">@n</hi>attribute values. Therefore, the encoding order of staves within a measure does not have to mimic the order of the <gi scheme="MEI">staffDef</gi> elements with <gi scheme="MEI">scoreDef</gi>. In addition to the parameters inherited from <gi scheme="MEI">scoreDef</gi>, the following attributes are important for <gi scheme="MEI">staffDef</gi> elements: <specList>
      <specDesc key="att.cleffing.log"
                atts="clef.line clef.shape clef.dis clef.dis.place"/>
   </specList> A staff with a tenor clef is encoded as in the following example:  In the case of transposing instruments, the key-related attributes described above may be used to override the written key expressed in the <gi scheme="MEI">scoreDef</gi> element. As a basic principle, MEI always captures written pitches, so the<hi rend="bold">@trans.diat</hi>and<hi rend="bold">@trans.semi</hi>attributes may be used to indicate the number of diatonic steps and semitones to calculate sounded pitch from written pitch. The piccolo and E♭ clarinet staves in the example below utilize these attributes:  There are a number of additional elements that can be used as children of <gi scheme="MEI">staffDef</gi> in order to describe additional features of the staff, such as the color of a clef or a key signature added in a different hand. These elements include: <specList>
      <specDesc key="clef"/>
   </specList>
   <specList>
      <specDesc key="clefGrp"/>
   </specList>
   <specList>
      <specDesc key="keySig"/>
   </specList>
   <specList>
      <specDesc key="keyAccid"/>
   </specList>
   <specList>
      <specDesc key="label"/>
   </specList>
   <specList>
      <specDesc key="meterSig"/>
   </specList>
   <specList>
      <specDesc key="meterSigGrp"/>
   </specList> With the exception of <gi scheme="MEI">label</gi>, these elements may also occur within the flow of musical events captured in a <gi scheme="MEI">layer</gi>, since they are members of <ident type="class">model.eventLike</ident>. In the layer context they function as milestones and affect all following content assigned to the layer (even in subsequent measures) until their information is again overridden either by the same element bearing different information or a <gi scheme="MEI">staffDef</gi> or <gi scheme="MEI">scoreDef</gi>. In this context, it is also possible to combine them with the elements described in chapters <ptr target="critApp"/> and <ptr target="editTrans"/> of these Guidelines. Such flexibility as this may require close inspection of an encoding to retrieve the correct definitions for a given staff. As a general rule, the closest preceding and most specific element provides this information: For example, a <gi scheme="MEI">keySig</gi> in the preceding measure is more relevant than a <gi scheme="MEI">staffDef</gi> at the beginning of the section, which is more relevant than a <gi scheme="MEI">scoreDef</gi> at the beginning of the score. However, a section-specific <gi scheme="MEI">scoreDef</gi> that provides only information about the meter does not override the more specific information about key signature gathered from a <gi scheme="MEI">staffDef</gi> for a transposing instrument. Every <gi scheme="MEI">staffDef</gi> may contain a number of <gi scheme="MEI">layerDef</gi> elements, which may be used to establish default values for the distinct layers sharing one staff. MEI does not use the term ‘voice’ to describe these ‘musical threads’ because that term implies continuity across measure boundaries. Given the sometimes arbitrary relationships between these threads from measure to measure as well as across staves, MEI uses the more neutral term ‘layer’.</p>
